# 「WordPressで学ぶPHP ②データ構造(配列・オブジェクト)編」 藤本壱

2023/08/27~08/28

## 配列変数の基本

- 同じ性質を持った大量のデータを扱うのに便利
- 配列変数への代入方法
  - キーを指定して代入 ..$配列名[キー]= 値;
  - まとめて代入 ..$配列名=array(値0,値1,値2,...);
                 ..$配列名=[値0,値1,値2,...];
  - array文でキーを指定して代入 ..$配列名=array(キーA => 値A, キーB => 値B,...);
    - 一部のキーを省略することもできる ..その場合省略したところのキーは直前のキーに1を加えた値になる

- get_posts関数
- setup_postdata関数
- coun(配列名) ..配列の要素の数を返す
- foreach文 ..foreach($配列名 as $変数名){各要素に対して繰り返す処理}
- <?php foreach($配列名 as $変数名):?>
  各要素に対して繰り返し出力する内容
  <?php endforeach;?>
- arryay_reverse関数
- sort/rsort関数
  - 並べ替え方法の指定
    - sort_numeric
    - sort_string
    - sort_natural
- array_push ..配列の末尾に新しい要素を追加
- array_unshift ..配列の先頭に新しい要素を追加
- array_pop ..配列の末尾から要素を取り出す
- array_shift ..配列の先頭から要素を取り出す
- array_marge ..配列を結合する
- array_slice ..配列から一部の要素を取り出す
- list(変数1,変数2,...)=配列 ..配列に入っている一連の要素を別々の変数に代入

## 連想配列と多次元配列

- 連想配列の書き方
  - $配列名[キー文字列]=値;

- 二次元配列 ..2つのキーで要素を指定する
  - $配列名[キー][キー]=値;
  - $配列名=array(
    array(値1,値2,値3),
    array(値4,値5,値6)
    );
  - $配列名=[
    [値1,値2,値3],
    [値4,値5,値6]
    ];

- 多次元配列

- foreach($ar as $key=>$value)
- array_keys($配列名) ..配列からキーだけ取り出す
- array_values($配列名) ..配列から値だけ取り出す
- extract(連想配列) ..キーが変数名、値がその変数の値
- asort/arsort ..キーと値の対応を保ったまま値の順番で並び替える
- ksort/krsort ..キーと値の対応を保ったままキーの順番で並び替える

## オブジェクト指向

- オブジェクトはプロパティとメソッドで構成されている
- オブジェクト指向プログラミングの手順
  1. オブジェクトのひな型(クラス)としてプロパティやメソッドを定義
  2. オブジェクトの初期化
  3. プロパティを調べたり、変えたり
  4. メソッドを呼び出して処理

### 既存のクラスの利用

- オブジェクトの作成
- 変数= new クラス名(パラメータ);
- WotdPressのコアで定義している主なクラス
  - WP_Post   投稿
  - WP_User   ユーザー
  - WP_Role   権限
  - WP_Http   HTTPリクエスト
  - WP_Theme  テーマ
  - WP_Widget ウィジェット
  - WP_Query  投稿の読み込み
- オブジェクトのプロパティの操作
- オブジェクトのプロパティを表すには->を使う
  - ex. $obj -> name  (objオブジェクトのnameプロパティ)
- オブジェクトのメソッドを実行する
  - プロパティと同様に->を使う
  - ex. $file -> save_as('sample.txt');

### WP_Queryクラスのオブジェクト利用(事例学習)

- オブジェクトの作成
``` $query = new WP_Query('orderby=date&order=DESC&posts_per_page=-1'); ```

- WP_Queryクラスのプロパティ
  - query       オブジェクトの作成時に指定した条件
  - posts       読み込まれた投稿の配列
  - request     投稿を読みだすために発行されたSQL
  - post_count  読み込まれた投稿の件数

- WP_Queryクラスのメソッド
  - have_posts      次の投稿があるかどうかを判断する
  - the_post        次の1件の投稿を読みだして初期化する
  - rewind_posts    先頭の投稿に戻る

- オブジェクトの内容の出力
  - var_dump
  - print_r

- クラス/オブジェクトに関連する関数
  - is_object(変数)                                           変数がオブジェクトを指していればtrue,そうでなければfalse
  - get_class(オブジェクト)                                   オブジェクトのクラス名
  - class_exists(クラス名)                                    クラスが定義されていればtrue,定義されていなければfalse
  - property_exists(クラス名またはオブジェクト,プロパティ名)  クラスまたはオブジェクトに、指定したプロパティが存在すればtrue,しなければfalse
  - method_exists(クラス名またはオブジェクト,メソッド名)      クラスまたはオブジェクトに、指定したメソッドが存在すればtrue,しなければfalse
