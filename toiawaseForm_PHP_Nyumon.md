2023/08/23~08/25

# 「PHP入門 確認画面つきのお問い合わせフォーム」 DESIGNMAP

- PHPでは変数にはドル記号($)を頭につける
- ```<?php echo $subject ?>``` - 変数subjectの値をecho文で出力
- 変数が値におきかわることを変数の展開という
- PHPは、Webサーバー側で処理される
- そのためwebブラウザはPHPのソースコードを読むことができない
- 変数は何度でも上書きされる
- ```$_POST```は、PHPが自動で生成する連想配列
- getメソッド ..検索エンジンでキーワードを送るときに使われる
  データベースからデータを取得するときはgetメソッド
  データベースに影響を与えないときはgetメソッド
- postメソッド ..データベースのデータに影響を与えるときはpostメソッド
- var_dump関数は、連想配列の中身を確認するときに使う
  preタグを前後に出力すると連想配列の出力が見やすくなる
- submitをクリックすると、フォームのデータは、サーバー側のform1.phpに送られ、```$_POST```に自動で格納される
- HTMLのname属性の値が、キー名になる
- HTMLは再出力され、ブラウザに戻される
- HTMLは再出力されているので、フォーム欄は空
- 入力されたデータを保持するには別な実装が必要
- isset関数は、変数や連想配列がセットされており、値がnullではないかを確認し、nullならfalse、そうでなければtrueを返す
- foreach ..配列のキーとキーに対応する値を先頭から自動で取り出して特定の処理を繰り返し行える
  ```foreach(配列 as 変数){処理}``` ..変数には配列の要素が代入される
- htmlspecialchars関数 ..ユーザーの入力値を安全に処理する関数
- ```$_SESSION```は、PHPが実行時に自動で生成する連想配列
- セッションとは、複数のリクエストとレスポンスをまたいで、Webサーバー側で状態やデータを維持できる仕組み(通常は保持しない)
- クッキーとは、Webサーバーから命令して、Webブラウザ側に保存される小さなテキストファイル
- 次回の通信のときに、このクッキーがサーバー側に送られることによって、サーバー側は、同じユーザーかどうかの判断ができる
- header関数 ..WebサーバーからWebブラウザへのレスポンスヘッダに追加する関数
- ```Location:```をヘッダに追加することで、Webブラウザはすぐに指定されたページをwebサーバーに再度リクエストする
- nl2br関数は、引数で渡されたデータのすべての改行文字の前に```<br>```を挿入して返す関数
- ```<a href="form1.php?action=edit">```は、URLパラメータと呼ばれる
- URLの後ろにデータをくっつけて、PHPのGETメソッドでデータを送ることができる。(actionは変数名、editが変数の値。どちらも任意の文字列)
- クロスサイトリクエストフォージェリ ..ユーザーがあるサイトでログインした状態で、他のサイトを閲覧しただけで、そのサイトにコードが仕掛けられていると、ユーザーが意図しない操作を、ユーザーの権限を利用して実行する攻撃
- 対策としてワンタイムチケットの発行
- ```$_SESSION['token'] = base64_encode(openssl_random_pseudo_bytes(48));```
- ```base64_encode```関数は、MIME base64方式でデータをエンコードする関数
- ```openssl_random_pseudo_bytes```関数は、疑似乱数のバイト文字列を生成する関数

### データベースの作成
- create database データベース名;
- use データベース名
- テーブルの作成(カラムとデータ型を設定)
- show columns from テーブル名; ..テーブル構造の確認
- select * from テーブル名; ..データの確認

### PHPからデータベース接続